function cloneFormNodes(t,e){for(var n=new Array,i=0;i<t.length;i++){if("#text"!=t[i].nodeName){n[i]=document.createElement(t[i].nodeName);for(var r=0,o=t[i].attributes.length;r<o;r++)n[i].setAttribute(t[i].attributes[r].name,t[i].attributes[r].value);FORM_ELEMENTS.includes(t[i].nodeName)?(n[i].name=e+t[i].name,n[i].id=e+t[i].id):"LABEL"==t[i].nodeName?n[i].setAttribute("for",e+t[i].getAttribute("for")):(t[i].id&&(n[i].id=e+t[i].id),t[i].name&&(n[i].name=e+t[i].name))}else n[i]=t[i].cloneNode(!0);if(t[i].childNodes.length>0)for(var a=cloneFormNodes(t[i].childNodes,e),d=0,s=a.length;d<s;d++)n[i].appendChild(a[d])}return n}function Template(t,e){this.nodes=Array(),this.prefix=e,this.currentIteration=0;for(var n=0,i=t.childNodes.length;n<i;n++)this.nodes[n]=t.childNodes[0].cloneNode(!0),t.removeChild(t.childNodes[0]);this.createInstance=function(){var t,e="",n=document.createElement("div"),i=document.createElement("div");i.innerHTML="Remove",i.setAttribute("type","button"),i.setAttribute("class","btn btn-danger multiform-remove"),this.prefix&&(e=this.prefix+"_"),e+=this.currentIteration.toString()+"-",n.id=e+"item_container",i.setAttribute("data-itemcontainer",n.id),t=cloneFormNodes(this.nodes,e);for(var r in t)n.appendChild(t[r]);return n.appendChild(i),this.currentIteration++,n}}function MultiformContainer(t){this.container=t,this.controlsContainer=document.createElement("div"),this.addButton=document.createElement("div"),this.addButton.innerHTML="Add",this.addButton.setAttribute("type","button"),this.addButton.setAttribute("class","btn btn-success"),this.addButton.setAttribute("id","multiform-add"),this.controlsContainer.setAttribute("id","multiform-controls"),this.controlsContainer.appendChild(this.addButton),this.container.appendChild(this.controlsContainer),this.appendChild=function(t){this.container.appendChild(t),$(".multiform-remove").unbind("click"),$(".multiform-remove").click(function(){$("#"+$(this).data("itemcontainer")).remove()})}}Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),i=n.length>>>0;if(0===i)return!1;for(var r=0|e,o=Math.max(r>=0?r:i-Math.abs(r),0);o<i;){if(function(t,e){return t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)}(n[o],t))return!0;o++}return!1}});var FORM_ELEMENTS=["DATALIST","INPUT","OPTGROUP","SELECT","TEXTAREA"];!function(t){t.fn.multiForm=function(e){var n=this.filter(".multiform-item"),i=Array(),r=new Template(this.not(".multiform-item")[0],e),o=new MultiformContainer(this.not(".multiform-item")[0]),a=0;for(n.length;a<n.length;a++)itemsArrayIndex=i.length,i[itemsArrayIndex]=new Template(n[a],e),i[itemsArrayIndex].currentIteration=a,o.appendChild(i[itemsArrayIndex].createInstance());return r.currentIteration=n.length,o.appendChild(r.createInstance()),t("#multiform-add").click(function(){o.appendChild(r.createInstance())}),this}}(jQuery);
